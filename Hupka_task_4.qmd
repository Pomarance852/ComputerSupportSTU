---
title: "Task4"
author: "Michal Hupka"
format: html
editor: visual
---

```{r}


# ============================================
# TOOLKIT FOR WORLD CITIES ANALYSIS
# ============================================

# Load required libraries
library(readr)
library(dplyr)

# --------------------------------------------
# 4.1 Greeting Function
# --------------------------------------------
welcome_to_my_universe <- function(your_name, universe_name) {
  cat("--------------------------------\n")
  cat("Analysis Toolkit for:", universe_name, "\n")
  cat("Report prepared by:", your_name, "\n")
  cat("--------------------------------\n\n")
}

# Example call:
welcome_to_my_universe("Michal Hupka", "World Cities Universe")

# --------------------------------------------
# 4.2 Loading and Inspecting Function
# --------------------------------------------
load_and_inspect <- function(file_path) {
  data <- read_csv(file_path)
  cat("--- Data Loaded:", file_path, "---\n")
  print(glimpse(data))
  cat("\n--- First 6 Rows: ---\n")
  print(head(data))
  return(data)
}

# Example call:
# my_data <- load_and_inspect("worldcities.csv")

# --------------------------------------------
# 4.3 Query Function: Filter Cities by Population
# --------------------------------------------
filter_cities_by_population <- function(data, pop_threshold) {
  result <- data |>
    filter(population > pop_threshold) |>
    select(city, country, population) |>
    arrange(desc(population))
  
  return(result)
}

# Example call:
# big_cities <- filter_cities_by_population(my_data, 1000000)
# print(big_cities)

# --------------------------------------------
# 4.4 Reporting Function: Generate Report for a Country
# --------------------------------------------
generate_report <- function(data, country_name) {
  country_data <- data |>
    filter(country == country_name)
  
  avg_pop <- mean(country_data$population, na.rm = TRUE)
  max_pop <- max(country_data$population, na.rm = TRUE)
  min_pop <- min(country_data$population, na.rm = TRUE)
  record_count <- nrow(country_data)
  
  cat("--- Report for:", country_name, "---\n")
  cat("Number of Cities:", record_count, "\n")
  cat("Average Population:", round(avg_pop, 2), "\n")
  cat("Largest City Population:", max_pop, "\n")
  cat("Smallest City Population:", min_pop, "\n")
  cat("----------------------------------\n\n")
}

# Example calls:
# generate_report(my_data, "Poland")
# generate_report(my_data, "Germany")

# ============================================
# BONUS: Advanced Function - Top N Cities by Continent
# ============================================
top_cities_by_continent <- function(data, continent_name, n = 10) {
  result <- data |>
    filter(continent == continent_name) |>
    arrange(desc(population)) |>
    slice_head(n = n) |>
    select(city, country, population)
  
  return(result)
}

# Example call:
# top_cities <- top_cities_by_continent(my_data, "Europe", 10)
# print(top_cities)


```
